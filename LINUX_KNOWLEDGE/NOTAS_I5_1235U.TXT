******ACTUALIZAR EL KERNEL (SI NO LO HACES, LOS E-CORES PROVOCAN MICRO-STUTTERING Y HABRÍA QUE DESACTIVARLOS EN LA BIOS)*******

-Instalamos dependencias previas:

apt-get install lsb-release apt-transport-https ca-certificates curl --no-install-recommends

-Bajamos la firma del repo:
curl -fSsL https://pkgs.zabbly.com/key.asc | gpg --dearmor | sudo tee /usr/share/keyrings/linux-zabbly.gpg > /dev/null

-Creamos /etc/apt/sources.list.d/linux-zabbly.list con el contenido:
deb [arch=amd64 signed-by=/usr/share/keyrings/linux-zabbly.gpg] https://pkgs.zabbly.com/kernel/stable bookw    orm main

-Actualizamos los metadatos de apt:
apt-get update

-Instalamos el último kernel de zabbly:
apt install linux-zabbly

******AJUSTES EN LA BIOS (NECESARIO SÓLO SI TIENES UN KERNEL INFERIOR AL 6.5 POR SUS PROBLEMAS CON LA MEZCLA DE P-CORES Y E-CORES)***************

Desactiva los EFFICIENCY CORES, deja sólo los PERFORMANCE CORES, con HYPER THREADING activado.
(Los core EFFICIENCY provocan micro-stuttering en DOSBOX).

******Sonido en Linux************

Tenemos que hacerl a mano (incluso si usas DietPi, la utilidad dietpi-config nos permite seleccionar el hardware de audio pero por número,
así que no nos vale para nada porque el número cambia entre reinicios, hay que seleccionar por nombre).

-Instalamos alsa-utils:
apt-get install alsa-utils

POR HDMI:
Cemos qué cards y devices hay con: aplay -l
Vemos que el HDMI 0, que es el que suena en este cacharro, aparece listado como:
card 0: PCH [HDA Intel PCH], device 3: HDMI 0 [XG2401 SERIES]

Lo probamos con speaker-test:
speaker-test -c2 -D hw:PCH,3

Así que ahora creamos /etc/asound.conf donde especificamos el nombre de la CARD y el número de DEVICE:
(OJO: NO debemos especificar la CARD por número, porque el número cambia entre reinicios).

pcm.!default {                                                                                                 
        type hw                                                                                                
        card PCH                                                                                               
        device 3                                                                                               
}                                                                                                              
                                                                                                               
ctl.!default {                                                                                                 
        type hw                                                                                                
        card PCH                                                                                               
}

...Y ya suena todo lo de ALSA por defecto por el HDMI!

POR JACK TRASERO:

speaker-test -c2 -D hw:HID,0

Con lo que en /etc/asound.conf tendríamos:
pcm.!default {                                                                                                 
        type hw                                                                                                
        card HID                                                                                               
        device 0                                                                                               
}                                                                                                              
                                                                                                               
ctl.!default {                                                                                                 
        type hw                                                                                                
        card HID                                                                                               
}
*****CONFIGURACIÓN DE AUDIO/VIDEO EN RETROARCH******

-BIOS del ordenador (ver esto: https://kithara.com/en/faq/real-time-system/what-can-causes-a-jitter-at-real-time-tasks/):
	Resúmen: Desactiva el Hyper-Threading, Intel(R) SpeedStep, Race To Halt, Energy Efficient Turbo,
	Enhanced C-States (es lo que llaman C1E) y todo lo que hay debajo, y todas las opciones de eficiencia que veas.
-Video: VULKAN con SWAPCHAIN a 2
-Audio: ALSATHREAD con 44100Hz (es la frecuencia nativa de la mayoría de los cores) y LATENCY a 45 

*****COMPROBAR GOVERNOR DE LA CPU*********

cat /sys/devices/system/cpu/cpu0/cpufreq/scaling_governor
cat /sys/devices/system/cpu/cpu1/cpufreq/scaling_governor
cat /sys/devices/system/cpu/cpu2/cpufreq/scaling_governor
...etc
